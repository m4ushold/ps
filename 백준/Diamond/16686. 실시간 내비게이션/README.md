# [Diamond III] 실시간 내비게이션 - 16686 

[문제 링크](https://www.acmicpc.net/problem/16686) 

### 성능 요약

메모리: 99248 KB, 시간: 1072 ms

### 분류

자료 구조, 다이나믹 프로그래밍, 느리게 갱신되는 세그먼트 트리, 세그먼트 트리

### 제출 일자

2024년 5월 15일 09:17:38

### 문제 설명

<p>우리는 dijkstra가 고안한 알고리즘 덕분에 길을 쉽게 찾을 수 있지만, 그러다 보니 사람들은 몇몇 도로만 드나들게 되어 교통체증이 심해졌습니다. 이에 따라 한국도로공사는 도로의 통행시간 정보를 수정하여 내비게이션이 다른 경로를 추천하도록 하였습니다. 그러자 다른 도로들이 새롭게 막히기 시작했습니다.</p>

<p>새로운 도로들이 계속 막히다 보니 한국도로공사는 도로 정보를 더욱 자주 바꾸기 시작했습니다. 허나, dijkstra의 알고리즘은 도로 정보를 바꿀 때마다 <em>O(E logV)</em> 만큼 연산을 수행하기에 내비게이션 서버가 다운이 되어버렸습니다.</p>

<p>큰 문제가 생기자 내비게이션 회사는 도로 정보가 바뀔 때 빨리 최단경로를 구해주는 소프트웨어를 새로 짜기 시작했습니다. 회사는 우선 수요가 많은 강변북로 및 올림픽대로 구간만 모델링하여 최단경로를 구하려고 합니다.</p>

<p>한강 북쪽에 강변북로, 남쪽에 올림픽대로가 있으며 강변북로와 올림픽대로에 각각 <em>N</em> 개의 나들목이 있습니다. 강변북로에 있는 나들목의 코드는 가장 서쪽에 있는 것부터 순서대로 N-<em>1, </em>N-<em>2</em>, ... , N-<em>N</em><em> </em>이고, 올림픽대로에 있는 나들목의 코드는 서쪽부터 순서대로 S-<em>1</em>, S-<em>2</em> , ... , S-<em>N</em><em> </em>입니다. 강변북로 <em>i</em> 번째 도로는 N-<em>i</em><em> </em>번 나들목과 N-<em>i+1</em><em> </em>번 나들목을 이으며, 올림픽대로 <em>i</em> 번째 도로는 S-<em>i</em><em> </em>번 나들목과 S-<em>i+1</em><em> </em>번 나들목을 잇습니다. 한강에 있는 <em>i </em>번째 다리는 N-<em>i</em> 번 나들목과 S-<em>i</em> 번 나들목을 잇습니다. 각 도로 및 다리는 드나드는데 일정한 시간이 걸립니다.</p>

<p>내비게이션 서버는 맨 처음에 <em>3N-2 </em>개 도로의 통행 시간 정보를 갖고 있습니다. 거기에 더해, 내비게이션 서버는 한국도로공사 서버로부터 '특정 도로의 통행 시간이 바뀌었다'라는 정보를 받습니다. 이 정보를 토대로 내비게이션 서버는 수시로 운전자가 '여기에서 저기로 가는 가장 빠른 길을 알려주세요'라고 물을 때마다 재빨리 답을 구하여 보내야 합니다. 빠르게 두 종류의 쿼리를 처리하는 프로그램을 작성하세요. 단, 다리를 여러 번 건너는 경로도 답이 될 수 있습니다.</p>

### 입력 

 <p>첫 번째 줄에 다리의 수 <em>N</em> 이 주어집니다. (2 ≤ N ≤ 300,000)</p>

<p>두 번째 줄에는 강변북로에 있는 <em>N-1 </em>개의 길을 지나는데 걸리는 시간 <em>N<sub>i</sub> </em>가 서쪽 도로부터 순서대로 주어집니다. (1 ≤ <em>N<sub>i</sub></em> ≤ 1,000,000,000)</p>

<p>세 번째 줄에는 올림픽대로에 있는 <em>N-1 </em>개의 길을 지나는데 걸리는 시간 <em>S<sub>i </sub></em>가 서쪽 도로부터 순서대로 주어집니다. (1 ≤ <em>S<sub>i</sub></em> ≤ 1,000,000,000)</p>

<p>네 번째 줄에는 한강에 있는 <em>N</em> 개의 다리를 지나는데 걸리는 시간<em> B<sub>i</sub> </em>가 서쪽 다리부터 순서대로 주어집니다. (1 ≤ <em>B<sub>i</sub></em> ≤ 1,000,000,000)</p>

<p>다섯 번째 줄에는 쿼리의 수 <em>Q</em>가 주어집니다. (1 ≤ <em>Q</em> ≤ 300,000)</p>

<p>여섯 번째 줄부터 <em>Q</em> 개의 줄에는 아래와 같은 형식으로 쿼리가 주어집니다.</p>

<ul>
	<li><em>1</em> <em>a b</em> : <em>a</em> 번 나들목에서 <em>b</em> 번 나들목까지 가는데 걸리는 최소 시간을 구해라. <em>a</em> 와 <em>b</em> 는 서로 다르며, 강변북로 <em>x</em> 번째 나들목은 <em>Nx</em> 꼴로, 올림픽대로 <em>x</em> 번째 나들목은 <em>Sx</em> 꼴로 주어진다.</li>
	<li><em>2</em> <em>a N<sub>a</sub></em> : 강변북로 <em>a</em> 번째 도로를 지나는데 걸리는 시간이 <em>N<sub>a</sub></em> 로 바뀐다. (1 ≤ <em>a</em> ≤ <em>N-1</em>, 1 ≤ <em>N<sub>a</sub></em> ≤ 1,000,000,000)</li>
	<li><em>3</em> <em>b S<sub>b</sub></em> : 올림픽대로 <em>b</em> 번째 도로를 지나는데 걸리는 시간이 <em>S<sub>b</sub></em> 로 바뀐다. (1 ≤ <em>b</em> ≤ <em>N-1</em>, 1 ≤ <em>S<sub>b</sub></em> ≤ 1,000,000,000)</li>
	<li><em>4</em> <em>c B<sub>c</sub></em> : 한강에 있는 <em>c</em> 번째 다리를 지나는데 걸리는 시간이 <em>B<sub>c</sub></em> 로 바뀐다. (1 ≤ <em>c</em> ≤ <em>N</em>, 1 ≤ <em>B<sub>c</sub></em> ≤ 1,000,000,000)</li>
</ul>

### 출력 

 <p>1번 쿼리에 대하여, 쿼리의 답을 한 줄에 하나씩 출력합니다. 1번 쿼리가 적어도 한 번 나오는 것은 보장됩니다.</p>

