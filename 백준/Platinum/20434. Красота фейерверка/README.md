# [Platinum V] Красота фейерверка - 20434 

[문제 링크](https://www.acmicpc.net/problem/20434) 

### 성능 요약

메모리: 33300 KB, 시간: 80 ms

### 분류

다이나믹 프로그래밍, 트리에서의 다이나믹 프로그래밍, 트리

### 제출 일자

2025년 10월 29일 16:37:35

### 문제 설명

<p>В лаборатории теоретической пиротехники изучают новые технологии организации фейерверков. Фейерверк представляется как корневое дерево, а поскольку в мощном фейерверке его элементы также взрываются, порождая новые фейерверки, то ученые вводят операцию возведения корневого дерева в степень.</p>

<p>Корневое дерево содержит одну или несколько вершин. Одна из вершин выделена и называется корнем дерева, для каждой из остальных вершин ровно одна другая вершина является родителем. При этом от любой вершины можно добраться до корня, последовательно переходя от вершины к ее родителю. Вершина, которая не является родителем никакой другой вершины, называется листом. Если вершина x является родителем вершины y, то вершина y является ребенком вершины x. Будем говорить, что вершина и ее родитель соединены ребром.</p>

<p>На рис. 1 показан пример корневого дерева с корнем в вершине 1. Родителем вершин 2 и 3 является вершина 1, родителем вершины 4 является вершина 2. Вершины 2 и 3 — дети вершины 1, а вершина 4 — ребенок вершины 2. Листьями являются вершины 3 и 4.</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/3becf35f-9a0f-4f9b-b01e-257eff36e33e/-/preview/" style="width: 92px; height: 138px;"></p>

<p style="text-align: center;">Рис. 1. Пример корневого дерева с корнем в вершине 1, листьями 3 и 4.</p>

<p>Фейерверк задается своим базовым деревом T и мощностью m. Фейерверк представляется деревом, которое получается в результате возведения дерева T в степень m. Операция возведения дерева в степень устроена следующим образом. Если m = 1, то результат T<sup>1</sup> — само дерево T. Для m > 1 рассмотрим дерево T<sup>m–1</sup>. Выполним следующую операцию: для каждого листа x дерева T<sup>m–1</sup> создадим копию дерева T и назначим лист x родителем корня соответствующей копии. Получившееся дерево будет деревом T<sup>m</sup>.</p>

<p>На рис. 2 показано дерево, представленное на рис. 1, в степенях 1, 2 и 3.</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/de3aeca7-2831-463a-932c-efc7d835ebe8/-/preview/" style="width: 404px; height: 210px;"></p>

<p style="text-align: center;">Рис. 2. Пример возведения дерева в степени 1, 2 и 3.</p>

<p>Путем в дереве называется последовательность вершин, в которой две соседние вершины соединены ребром. Все вершины в пути должны быть различны.</p>

<p>Для того, чтобы оценить красоту фейерверка, необходимо определить, какое максимальное количество вершин может содержать путь в дереве, которым представляется фейерверк. На рис. 3 приведен путь в дереве T<sup>2</sup>, содержащий максимальное количество вершин. Таким образом, красота фейерверка с базовым деревом T и мощностью 2 равна 10.</p>

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/e99fcbf7-acc5-4f1a-a580-30c95f1a1a8f/-/preview/" style="width: 106px; height: 161px;"></p>

<p style="text-align: center;">Рис. 3. Путь в дереве T<sup>2</sup>, содержащий максимальное количество вершин.</p>

<p>Требуется написать программу, которая по описанию дерева T и натуральному числу m определяет красоту фейерверка с базовым деревом T и мощностью m.</p>

### 입력 

 <p>Первая строка входных данных содержит два натуральных числа n и m — количество вершин в базовом дереве фейерверка T и его мощность (3 ≤ n ≤ 200 000, 1 ≤ m ≤ 200 000).</p>

<p>Вторая строка описывает дерево T и содержит (n – 1) целых чисел: p<sub>2</sub>, p<sub>3</sub>, …, p<sub>n</sub> — номера родителей вершин 2, 3, …, n, соответственно (1 ≤ p<sub>i</sub> ≤ i – 1).</p>

### 출력 

 <p>Требуется вывести одно целое число — красоту фейерверка, представляемого деревом T<sup>m</sup>.</p>

